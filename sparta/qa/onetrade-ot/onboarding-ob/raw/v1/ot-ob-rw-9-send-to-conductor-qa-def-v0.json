{"id":"098073b2-10f6-4d26-ae69-aacaeef77efc","name":"ot-ob-rw-9-send-to-conductor-qa-def","description":"Lanzamiento de onboarding a conductor","settings":{"global":{"executionMode":"marathon","userPluginsJars":[],"preExecutionSqlSentences":[],"postExecutionSqlSentences":[],"addAllUploadedPlugins":true,"mesosConstraint":"spark:true","mesosConstraintOperator":"LIKE","parametersLists":["Environment"],"parametersUsed":["COUNTRY","DATE","Global.SPARK_CORES_MAX","Global.SPARK_DRIVER_CORES","Global.SPARK_DRIVER_JAVA_OPTIONS","Global.SPARK_DRIVER_MEMORY","Global.SPARK_EXECUTOR_CORES","Global.SPARK_EXECUTOR_EXTRA_JAVA_OPTIONS","Global.SPARK_EXECUTOR_MEMORY","Global.SPARK_LOCALITY_WAIT","Global.SPARK_LOCAL_PATH","Global.SPARK_MEMORY_FRACTION","Global.SPARK_TASK_MAX_FAILURES"],"udfsToRegister":[],"udafsToRegister":[],"mesosRole":"","marathonDeploymentSettings":{"gracePeriodSeconds":"240","intervalSeconds":"20","timeoutSeconds":"20","maxConsecutiveFailures":"3","forcePullImage":true,"privileged":false,"userEnvVariables":[],"userLabels":[],"logLevel":""},"enableQualityRules":true},"streamingSettings":{"window":"2s","blockInterval":"100ms","checkpointSettings":{"checkpointPath":"sparta/checkpoint","enableCheckpointing":true,"autoDeleteCheckpoint":true,"addTimeToCheckpointPath":false}},"sparkSettings":{"master":"mesos://zk://master.mesos:2181/mesos","sparkKerberos":true,"sparkDataStoreTls":true,"sparkMesosSecurity":true,"submitArguments":{"userArguments":[],"deployMode":"client","driverJavaOptions":"{{{Global.SPARK_DRIVER_JAVA_OPTIONS}}}"},"sparkConf":{"sparkResourcesConf":{"coresMax":"{{{Global.SPARK_CORES_MAX}}}","executorMemory":"{{{Global.SPARK_EXECUTOR_MEMORY}}}","executorCores":"{{{Global.SPARK_EXECUTOR_CORES}}}","driverCores":"{{{Global.SPARK_DRIVER_CORES}}}","driverMemory":"{{{Global.SPARK_DRIVER_MEMORY}}}","mesosExtraCores":"","localityWait":"{{{Global.SPARK_LOCALITY_WAIT}}}","taskMaxFailures":"{{{Global.SPARK_TASK_MAX_FAILURES}}}","sparkMemoryFraction":"{{{Global.SPARK_MEMORY_FRACTION}}}","sparkParallelism":""},"sparkHistoryServerConf":{"enableHistoryServerMonitoring":false,"sparkHistoryServerEventLogRotateEnable":false,"sparkHistoryServerEventLogRotateNum":"9","sparkHistoryServerEventLogRotateSize":"512"},"userSparkConf":[],"coarse":true,"sparkUser":"","sparkLocalDir":"{{{Global.SPARK_LOCAL_PATH}}}","sparkKryoSerialization":false,"sparkSqlCaseSensitive":true,"logStagesProgress":false,"hdfsTokenCache":true,"executorExtraJavaOptions":"{{{Global.SPARK_EXECUTOR_EXTRA_JAVA_OPTIONS}}}"}},"errorsManagement":{"genericErrorManagement":{"whenError":"Error"},"transformationStepsManagement":{"whenError":"Error","whenRowError":"RowError","whenFieldError":"FieldError"},"transactionsManagement":{"sendToOutputs":[],"sendStepData":false,"sendPredecessorsData":true,"sendInputData":true}}},"pipelineGraph":{"nodes":[{"name":"XdRawOnboardingConductor","stepType":"Input","className":"CrossdataInputStep","classPrettyName":"Crossdata","arity":["NullaryToNary"],"description":"GTS_ONETRADE.raw_onboarding_conductor","uiConfiguration":{"position":{"x":82,"y":153}},"configuration":{"crossdata":"{\"database\":\"GTS_ONETRADE\",\"table\":\"raw_onboarding_conductor\"}","debugOptions":"{\"query\":\"Select * from GTS_ONETRADE.raw_onboarding_conductor limit 10 \"}","errorTableName":""},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[],"outputsWriter":[]},{"name":"FiltParam","stepType":"Transformation","className":"FilterTransformStep","classPrettyName":"Filter","arity":["UnaryToNary"],"description":"Filtro datos por parámetros","uiConfiguration":{"position":{"x":295,"y":153}},"configuration":{"filterExp":"paramDate=='{{{DATE}}}'\nAND \nparamCountry=='{{{COUNTRY}}}'","inputSchemas":"[]","errorTableName":""},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[],"outputsWriter":[]},{"name":"Sel","stepType":"Transformation","className":"SelectTransformStep","classPrettyName":"Select","arity":["UnaryToNary"],"description":"Selecciono las columnas para comprobar que está todo lo que espera conductor","uiConfiguration":{"position":{"x":553,"y":157}},"configuration":{"selectType":"EXPRESSION","selectExp":"country, agent, agentDescription, entity, internalRepresentUser, firstName, lastName, contactDataMail, \ncontactDataMOBI, documentType, documentCountry, documentNumber, relationshipType, typeDisposition, cmc, \nidentificationLegalCustomer, companyName, tradeName, companyStartDate, companyEndDate, companyType, \ncompanyAdditionalDetail, countryIncorporation, documentList, addressList, contactList, accountsList, \nglobalId, companyGlobalId, traceId, stepTimestamp, processTimestamp, fileName, onboardingType, rowCount\n","inputSchemas":"[]","errorTableName":""},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[],"outputsWriter":[{"saveMode":"Append","outputStepName":"Rest","tableName":"","discardTableName":"","extraOptions":{"saveMode":"Append"}}]},{"name":"Rest","stepType":"Output","className":"RestOutputStep","classPrettyName":"Rest","arity":["NullaryToNullary","NaryToNullary"],"description":"Hago llamada a conductor para enviar json con datos.","uiConfiguration":{"position":{"x":818,"y":155}},"configuration":{"requestTimeout":"30s","dropElementsStreamContinues":false,"HTTP_Body_Format":"JSON","errorSink":false,"url":"https://gts-conductor.conductor.gts.marathon.mesos:8443/api/workflow","httpMethod":"POST","errorTableName":"","HTTP_Header":[{"headerOptionsKey":"Content-Type","headerOptionsValue":"application/json"},{"headerOptionsKey":"Accept","headerOptionsValue":"text/plain"}],"HTTP_Body":"{\n  \"name\": \"massive_onboarding\",\n  \"version\": 1,\n  \"input\": {\n  \"country\": ${country},\n  \"agent\": ${agent},\n  \"agentDescription\": ${agentDescription},\n  \"entity\": ${entity},\n  \"internalRepresentUser\": ${internalRepresentUser},\n  \"firstName\": ${firstName},\n  \"lastName\": ${lastName},\n  \"contactDataMail\": ${contactDataMail},\n  \"contactDataMOBI\": ${contactDataMOBI},\n  \"documentType\": ${documentType},\n  \"documentCountry\": ${documentCountry},\n  \"documentNumber\": ${documentNumber},\n  \"relationshipType\": ${relationshipType},\n  \"typeDisposition\": ${typeDisposition},\n  \"cmc\": ${cmc},\n  \"companyId\": ${identificationLegalCustomer},\n  \"companyName\": ${companyName},\n  \"tradeName\": ${tradeName},\n  \"companyStartDate\": ${companyStartDate},\n  \"companyEndDate\": ${companyEndDate},\n  \"companyType\": ${companyType},\n  \"companyAdditionalDetail\": ${companyAdditionalDetail},\n  \"countryIncorporation\": ${countryIncorporation},\n  \"documentList\": ${documentList},\n  \"addressList\": ${addressList},\n  \"contactList\": ${contactList},\n  \"accountsList\": ${accountsList},\n  \"globalId\": ${globalId},\n  \"companyGlobalId\": ${companyGlobalId},\n  \"traceId\": ${traceId},\n  \"stepTimestamp\": ${stepTimestamp},\n  \"processTimestamp\": ${stepTimestamp},\n  \"fileName\": ${fileName},\n  \"rowCount\": ${rowCount},\n  \"onboardingType\": ${onboardingType}\n}\n}","statusCodeWhiteList":"","akkaHttpOptions":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","lineageProperties":[],"outputsWriter":[]}],"edges":[{"origin":"XdRawOnboardingConductor","destination":"FiltParam","dataType":"ValidData"},{"origin":"FiltParam","destination":"Sel","dataType":"ValidData"},{"origin":"Sel","destination":"Rest","dataType":"ValidData"}],"annotations":[]},"executionEngine":"Batch","uiSettings":{"position":{"x":0,"y":0,"k":1}},"lastUpdateDate":"2020-02-06T10:38:14Z","version":0,"group":{"id":"ab7361e4-761c-4883-afc8-b071f068f0dd","name":"/home/qa/onetrade-ot/onboarding-ob/raw/v1"},"debugMode":false,"versionSparta":"2.11.1-7a22d44","groupId":"ab7361e4-761c-4883-afc8-b071f068f0dd"}